"use strict";Object.defineProperty(exports, "__esModule", {value: true});var _chunkSGHKGXDYjs = require('./chunk-SGHKGXDY.js');var _chunkFKYXFL4Djs = require('./chunk-FKYXFL4D.js');var _chunk7MX4KGZOjs = require('./chunk-7MX4KGZO.js');var _chunkI6AUFTYSjs = require('./chunk-I6AUFTYS.js');var _chunkAJFV7TTFjs = require('./chunk-AJFV7TTF.js');var _chunkXRXWMM7Ajs = require('./chunk-XRXWMM7A.js');var _chunkEI7MMDWYjs = require('./chunk-EI7MMDWY.js');var _core = require('@goat-sdk/core');var _walletevm = require('@goat-sdk/wallet-evm');var _viem = require('viem');function m(g,n,t,e){var a=arguments.length,i=a<3?n:e===null?e=Object.getOwnPropertyDescriptor(n,t):e,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(g,n,t,e);else for(var r=g.length-1;r>=0;r--)(s=g[r])&&(i=(a<3?s(i):a>3?s(n,t,i):s(n,t))||i);return a>3&&i&&Object.defineProperty(n,t,i),i}_chunkEI7MMDWYjs.a.call(void 0, m,"_ts_decorate");function o(g,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(g,n)}_chunkEI7MMDWYjs.a.call(void 0, o,"_ts_metadata");var y="0xAc48FcF1049668B285f3dC72483DF5Ae2162f7e8",h="0x2e8614625226D26180aDf6530C3b1677d3D7cf10",G="0xB5F00c2C5f8821155D8ed27E31932CFD9DB3C5D5",d= exports.a =class{static{_chunkEI7MMDWYjs.a.call(void 0, this,"KimService")}async getSwapRouterAddress(n){return y}async swapExactInputSingleHop(n,t){try{let e=await n.sendTransaction({to:t.tokenInAddress,abi:_chunk7MX4KGZOjs.a,functionName:"approve",args:[y,t.amountIn]}),a=Math.floor(Date.now()/1e3)+t.deadline;return(await n.sendTransaction({to:y,abi:_chunkSGHKGXDYjs.a,functionName:"exactInputSingle",args:[{tokenIn:t.tokenInAddress,tokenOut:t.tokenOutAddress,recipient:n.getAddress(),deadline:a,amountIn:t.amountIn,amountOutMinimum:t.amountOutMinimum,limitSqrtPrice:t.limitSqrtPrice}]})).hash}catch(e){throw Error(`Failed to swap exact input single hop: ${e}`)}}async swapExactOutputSingleHop(n,t){try{let e=t.tokenInAddress,a=t.tokenOutAddress,i=t.amountOut,s=t.amountInMaximum,r=t.limitSqrtPrice,u=Math.floor(Date.now()/1e3)+t.deadline,b=await n.sendTransaction({to:t.tokenInAddress,abi:_chunk7MX4KGZOjs.a,functionName:"approve",args:[y,s]});return(await n.sendTransaction({to:y,abi:_chunkSGHKGXDYjs.a,functionName:"exactOutputSingle",args:[{tokenIn:e,tokenOut:a,recipient:n.getAddress(),deadline:u,amountOut:i,amountInMaximum:s,limitSqrtPrice:r}]})).hash}catch(e){throw Error(`Failed to swap exact output single hop: ${e}`)}}async swapExactInputMultiHop(n,t){try{let e=await n.resolveAddress(t.recipient),a=Number(await n.read({address:t.path.tokenIn,abi:_chunk7MX4KGZOjs.a,functionName:"decimals"})),i=Number(await n.read({address:t.path.tokenOut,abi:_chunk7MX4KGZOjs.a,functionName:"decimals"})),s=_viem.encodeAbiParameters.call(void 0, [{type:"address[]"},{type:"uint24[]"}],[[t.path.tokenIn,...t.path.intermediateTokens.map(u=>u),t.path.tokenOut],t.path.fees]);return(await n.sendTransaction({to:y,abi:_chunkSGHKGXDYjs.a,functionName:"exactInput",args:[s,e,t.deadline,_viem.parseUnits.call(void 0, t.amountIn,a),_viem.parseUnits.call(void 0, t.amountOutMinimum,i)]})).hash}catch(e){throw new Error(`Failed to swap: ${e}`)}}async swapExactOutputMultiHop(n,t){try{let e=await n.resolveAddress(t.recipient),a=Number(await n.read({address:t.path.tokenIn,abi:_chunk7MX4KGZOjs.a,functionName:"decimals"})),i=Number(await n.read({address:t.path.tokenOut,abi:_chunk7MX4KGZOjs.a,functionName:"decimals"})),s=_viem.encodeAbiParameters.call(void 0, [{type:"address[]"},{type:"uint24[]"}],[[t.path.tokenIn,...t.path.intermediateTokens.map(u=>u),t.path.tokenOut],t.path.fees]);return(await n.sendTransaction({to:y,abi:_chunkSGHKGXDYjs.a,functionName:"exactOutput",args:[s,e,t.deadline,_viem.parseUnits.call(void 0, t.amountOut,i),_viem.parseUnits.call(void 0, t.amountInMaximum,a)]})).hash}catch(e){throw new Error(`Failed to swap: ${e}`)}}async mintPosition(n,t){try{let a=t.token0Address.toLowerCase()<t.token1Address.toLowerCase(),[i,s]=a?[t.token0Address,t.token1Address]:[t.token1Address,t.token0Address],[r,u]=a?[t.amount0Desired,t.amount1Desired]:[t.amount1Desired,t.amount0Desired],k=(await n.read({address:G,abi:_chunkI6AUFTYSjs.a,functionName:"poolByPair",args:[i,s]})).value,L=(await n.read({address:k,abi:_chunkAJFV7TTFjs.a,functionName:"globalState"})).value,H=Number.parseInt(L[1].toString()),E=Math.floor(H/60)*60,B=E-60*10,$=E+60*10,W=await n.sendTransaction({to:i,abi:_chunk7MX4KGZOjs.a,functionName:"approve",args:[h,r]}),Y=await n.sendTransaction({to:s,abi:_chunk7MX4KGZOjs.a,functionName:"approve",args:[h,u]}),U=Math.floor(Date.now()/1e3)+t.deadline;return(await n.sendTransaction({to:h,abi:_chunkXRXWMM7Ajs.a,functionName:"mint",args:[{token0:i,token1:s,tickLower:B,tickUpper:$,amount0Desired:r,amount1Desired:u,amount0Min:0,amount1Min:0,recipient:n.getAddress(),deadline:U}]})).hash}catch(e){throw new Error(`Failed to mint position: ${e}`)}}async increaseLiquidity(n,t){try{let e=t.token0Address.toLowerCase()<t.token1Address.toLowerCase(),[a,i]=e?[t.token0Address,t.token1Address]:[t.token1Address,t.token0Address],[s,r]=e?[t.amount0Desired,t.amount1Desired]:[t.amount1Desired,t.amount0Desired],u=await n.sendTransaction({to:a,abi:_chunk7MX4KGZOjs.a,functionName:"approve",args:[h,s]}),b=await n.sendTransaction({to:i,abi:_chunk7MX4KGZOjs.a,functionName:"approve",args:[h,r]}),k=Math.floor(Date.now()/1e3)+60;return(await n.sendTransaction({to:h,abi:_chunkXRXWMM7Ajs.a,functionName:"increaseLiquidity",args:[{tokenId:t.tokenId,amount0Desired:s,amount1Desired:r,amount0Min:0n,amount1Min:0n,deadline:k}]})).hash}catch(e){throw new Error(`Failed to increase liquidity: ${e}`)}}async decreaseLiquidity(n,t){try{let s=(await n.read({address:h,abi:_chunkXRXWMM7Ajs.a,functionName:"positions",args:[t.tokenId]})).value[6]*BigInt(t.percentage)/BigInt(100),r=0n,u=0n,b=Math.floor(Date.now()/1e3)+60;return(await n.sendTransaction({to:h,abi:_chunkXRXWMM7Ajs.a,functionName:"decreaseLiquidity",args:[{tokenId:t.tokenId,liquidity:s,amount0Min:r,amount1Min:u,deadline:b}]})).hash}catch(e){throw new Error(`Failed to decrease liquidity: ${e}`)}}async collect(n,t){try{let e=n.getAddress(),a=BigInt(2**128)-BigInt(1);return(await n.sendTransaction({to:h,abi:_chunkXRXWMM7Ajs.a,functionName:"collect",args:[{tokenId:t.tokenId,recipient:e,amount0Max:a,amount1Max:a}]})).hash}catch(e){throw new Error(`Failed to collect: ${e}`)}}async burn(n,t){try{return(await n.sendTransaction({to:h,abi:_chunkXRXWMM7Ajs.a,functionName:"burn",args:[t.tokenId]})).hash}catch(e){throw new Error(`Failed to burn position: ${e}`)}}};m([_core.Tool.call(void 0, {name:"kim_get_swap_router_address",description:"Get the address of the swap router"}),o("design:type",Function),o("design:paramtypes",[typeof _chunkFKYXFL4Djs.a>"u"?Object:_chunkFKYXFL4Djs.a]),o("design:returntype",Promise)],d.prototype,"getSwapRouterAddress",null);m([_core.Tool.call(void 0, {description:"Swap an exact amount of input tokens for an output token in a single hop. Have the token amounts in their base units. Don't need to approve the swap router for the output token. User will have sufficient balance of the input token. The swap router address is already provided in the function. Returns a transaction hash on success. Once you get a transaction hash, the swap is complete - do not call this function again."}),o("design:type",Function),o("design:paramtypes",[typeof _walletevm.EVMWalletClient>"u"?Object:_walletevm.EVMWalletClient,typeof _chunkFKYXFL4Djs.e>"u"?Object:_chunkFKYXFL4Djs.e]),o("design:returntype",Promise)],d.prototype,"swapExactInputSingleHop",null);m([_core.Tool.call(void 0, {name:"kim_swap_exact_output_single_hop",description:"Swap an exact amount of output tokens for a single hop. Have the token amounts in their base units. Don't need to approve the swap router for the output token. User will have sufficient balance of the input token. The swap router address is already provided in the function. Returns a transaction hash on success. Once you get a transaction hash, the swap is complete - do not call this function again."}),o("design:type",Function),o("design:paramtypes",[typeof _walletevm.EVMWalletClient>"u"?Object:_walletevm.EVMWalletClient,typeof _chunkFKYXFL4Djs.f>"u"?Object:_chunkFKYXFL4Djs.f]),o("design:returntype",Promise)],d.prototype,"swapExactOutputSingleHop",null);m([_core.Tool.call(void 0, {name:"kim_swap_exact_input_multi_hop",description:"Swap an exact amount of input tokens in multiple hops"}),o("design:type",Function),o("design:paramtypes",[typeof _walletevm.EVMWalletClient>"u"?Object:_walletevm.EVMWalletClient,typeof _chunkFKYXFL4Djs.c>"u"?Object:_chunkFKYXFL4Djs.c]),o("design:returntype",Promise)],d.prototype,"swapExactInputMultiHop",null);m([_core.Tool.call(void 0, {name:"kim_swap_exact_output_multi_hop",description:"Swap tokens to receive an exact amount of output tokens in multiple hops"}),o("design:type",Function),o("design:paramtypes",[typeof _walletevm.EVMWalletClient>"u"?Object:_walletevm.EVMWalletClient,typeof _chunkFKYXFL4Djs.d>"u"?Object:_chunkFKYXFL4Djs.d]),o("design:returntype",Promise)],d.prototype,"swapExactOutputMultiHop",null);m([_core.Tool.call(void 0, {name:"kim_mint_position",description:"Mint a new liquidity position in a pool. Returns a transaction hash on success. Once you get a transaction hash, the mint is complete - do not call this function again."}),o("design:type",Function),o("design:paramtypes",[typeof _walletevm.EVMWalletClient>"u"?Object:_walletevm.EVMWalletClient,typeof _chunkFKYXFL4Djs.i>"u"?Object:_chunkFKYXFL4Djs.i]),o("design:returntype",Promise)],d.prototype,"mintPosition",null);m([_core.Tool.call(void 0, {name:"kim_increase_liquidity",description:"Increase liquidity in an existing position. Returns a transaction hash on success. Once you get a transaction hash, the increase is complete - do not call this function again."}),o("design:type",Function),o("design:paramtypes",[typeof _walletevm.EVMWalletClient>"u"?Object:_walletevm.EVMWalletClient,typeof _chunkFKYXFL4Djs.j>"u"?Object:_chunkFKYXFL4Djs.j]),o("design:returntype",Promise)],d.prototype,"increaseLiquidity",null);m([_core.Tool.call(void 0, {name:"kim_decrease_liquidity",description:"Decrease liquidity in an existing position by specifying a percentage (0-100). Returns a transaction hash on success. Once you get a transaction hash, the decrease is complete - do not call this function again."}),o("design:type",Function),o("design:paramtypes",[typeof _walletevm.EVMWalletClient>"u"?Object:_walletevm.EVMWalletClient,typeof _chunkFKYXFL4Djs.k>"u"?Object:_chunkFKYXFL4Djs.k]),o("design:returntype",Promise)],d.prototype,"decreaseLiquidity",null);m([_core.Tool.call(void 0, {name:"kim_collect",description:"Collect all available tokens from a liquidity position. Can be rewards or tokens removed from a liquidity position. So, should be called after decreasing liquidity as well as on its own."}),o("design:type",Function),o("design:paramtypes",[typeof _walletevm.EVMWalletClient>"u"?Object:_walletevm.EVMWalletClient,typeof _chunkFKYXFL4Djs.l>"u"?Object:_chunkFKYXFL4Djs.l]),o("design:returntype",Promise)],d.prototype,"collect",null);m([_core.Tool.call(void 0, {name:"kim_burn",description:"Burn a liquidity position NFT after all tokens have been collected."}),o("design:type",Function),o("design:paramtypes",[typeof _walletevm.EVMWalletClient>"u"?Object:_walletevm.EVMWalletClient,typeof _chunkFKYXFL4Djs.m>"u"?Object:_chunkFKYXFL4Djs.m]),o("design:returntype",Promise)],d.prototype,"burn",null);exports.a = d;
